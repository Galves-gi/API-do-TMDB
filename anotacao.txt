AXIOS
- o que √©?


- oq consegue fazer?

- onde usar?


- como usar?


EXPRESS
- o que √©?


- O que faz?


- Como usar?


DOTENV
- O QUE √â?


--------------------------------------------------

express-rate-limit

√â um middleware que limita o n√∫mero de requisi√ß√µes que um cliente pode fazer √† sua API em um determinado tempo.

    ‚û°Ô∏è Evita abuso / ataques (DoS, brute force)
    ‚û°Ô∏è Protege seu servidor
    ‚û°Ô∏è Diminui custo (menos chamadas ao TMDB, por exemplo)

    import rateLimit from "express-rate-limit";

    const limiter = rateLimit({
    windowMs: 15 * 60 * 1000,
    max: 100,
    });

    app.use(limiter);
* Cada cliente pode fazer no m√°ximo 100 requisi√ß√µes a cada 15 minutos.

Explica√ß√£o detalhada

    import rateLimit ---->	                Importa o pacote
    const limiter = rateLimit({...}) ---->	Cria configura√ß√£o
    windowMs: 15 * 60 * 1000 ---->	        Tempo da janela ‚Üí 15 minutos
    max: 100 ---->	                        M√°ximo permitido ‚Üí 100 requisi√ß√µes
    app.use(limiter) ---->	                Aplica o limitador em todas as rotas

--------------------------------------------------

PROTEGER BACKEND CONTRA INJE√á√ïES

xss-clean

XSS (Cross-Site Scripting)
√â quando algu√©m envia c√≥digo malicioso (como <script>alert("hack")</script>) para ser executado no navegador de outros usu√°rios.

O que xss-clean faz?

    ‚úî Remove tags e scripts maliciosos
    ‚úî Limpa dados de entrada
    ‚úî Evita execu√ß√£o de c√≥digo inserido pelo usu√°rio

Como funciona na pr√°tica
    üîπ Ele roda antes das rotas
    üîπ Inspeciona req.body, req.query, req.params
    üîπ Remove conte√∫do malicioso

express-mongo-sanitize ‚Üí √© mais √∫til em apps que usam Mongo/Mongoose. Por√©m, √© √∫til para sanitizar inputs de pesquisa.

    Se o backend n√£o sanitiza isso ($gt, $set, $or, .), pode:
    ‚úÖ Logar sem senha
    ‚úÖ Alterar dados
    ‚úÖ Expor informa√ß√µes

O que mongoSanitize() faz?

    ‚úî Remove operadores iniciados com $ e .
    ‚úî Impede inje√ß√£o nas queries

--------------------------------------------------

As retic√™ncias ... 

{
  ...dadosInformacoesFilme,
  poster_url: posterURL
}


se chamam "spread operator" (operador de espalhamento).

√â um recurso do JavaScript que permite espalhar (copiar) todas as propriedades de um objeto, array ou iter√°vel, dentro de outro objeto/array.

    - Pega todos os dados retornados da API do TMDB

    - Espalha dentro desse novo objeto

    - Adiciona a chave extra poster_url

--------------------------------------------------

MIDDLEWARE

Middleware √© uma fun√ß√£o que fica entre a requisi√ß√£o e a resposta.

Ele intercepta a requisi√ß√£o antes que ela chegue na rota final, podendo:

    ‚úî Inspecionar req
    ‚úî Alterar req e res
    ‚úî Bloquear
    ‚úî Registrar
    ‚úî Fazer parsing
    ‚úî Autentica√ß√£o
    ‚úî Autorizar
    ‚úî Validar
    ‚úî Tratar erros

Situa√ß√£o para usar?
    v√°rias rota
    Seguran√ßa
    Logs	
    Parsing	
    Validar token	
    Capturar erros



req ‚Üí dados do cliente

res ‚Üí resposta para o cliente

next() ‚Üí chama o pr√≥ximo middleware/rota

Se n√£o chamar next(), a cadeia para ali.

    function meuMiddleware(req, res, next) {
    console.log("Passou pelo middleware");
    next(); // continua
    }


MIDDLEWARE DE ERROS


Por qu√™ usar req, res e next:
    - Mesmo que voc√™ n√£o use req e res dentro dele, eles precisam estar presentes para o Express entender que √© um middleware que recebe requisi√ß√£o e encaminha adiante.
        ‚úîÔ∏è req ‚Üí dados da requisi√ß√£o
        ‚úîÔ∏è res ‚Üí resposta
        ‚úîÔ∏è next(error) ‚Üí encaminha para middleware de erro

- Certifique-se de colocar o middleware ap√≥s as rotas. Se colocar antes, ele nunca ser√° acionado.
    app.use("/api", router);

    // ‚¨á precisa vir depois das rotas
    app.use(errorHandler);


--------------------------------------------------

try....catch
catch:

    console.log(error.response?.data);

    ? √© o optional chaining no JavaScript:
        -> ‚ÄúAcesse a propriedade somente se ela existir.‚Äù


--------------------------------------------------

HEADERS

Authorization: Bearer SEU_TOKEN_AQUI

Bearer : 
    A palavra ‚Äúbearer‚Äù vem do ingl√™s e quer dizer portador.
    Ent√£o Bearer Token significa:

    Quem estiver portando este token tem permiss√£o para acessar o recurso.


--------------------------------------------------

PADR√ÉO NBC - MODULE


--------------------------------------------------

SERVER


app.use(express.json())

    Por padr√£o, o Express n√£o sabe interpretar JSON sozinho.
    uzir o corpo (body) em objeto JS.

    √â um middleware do Express que faz o servidor entender JSON enviado (frontend, Postman, mobile, etc) no corpo da requisi√ß√£o (req.body).

    Sem isso, o req.body vem undefined.

    Quando √© usado?
        - POST
        - PUT
        - PATCH
        E enviar dados no body.




app.all("*")

    - * captura qualquer rota que n√£o existe (vers√£o express baixo de 5)

    - all captura qualquer m√©todo: GET, POST, PUT, DELETE, etc.

mesma solu√ß√£o para express atual:
    app.use((req, res, next) => {
    const error = new Error("Rota n√£o encontrada");
    error.status = 404;
    next(error);
    });


--------------------------------------------------
Router()

Router() √© uma fun√ß√£o do Express que cria um mini-app, ou seja:
um objeto capaz de:

    ‚úî criar rotas
    ‚úî aplicar middlewares
    ‚úî ser montado no app principal

Ele funciona como um subservidor para organizar endpoints.



ROTA COM PAR√ÇMETROS

app.get("/filme/:id", async (req, res) => {
  ...
})
A v√≠rgula est√° separando dois argumentos da fun√ß√£o app.get() OBRIGAT√ìRIOS: app.get(path, callback)

   1- Primeiro argumento(STRING):
    O caminho (rota) ‚Üí "/filme/:id" // minha rota, como a pessoa vai acessar meu site e receber a respota

   2- Segundo argumento(FUN√á√ÉO):
    A fun√ß√£o que ser√° executada quando essa rota for chamada
    ‚Üí async (req, res) => { ... }

    - req ‚Üí informa√ß√µes da requisi√ß√£o

    - res ‚Üí objeto usado para responder




const id = req.params.id X const { id } = req.params

- O Express entende que o trecho :id √© uma vari√°vel na URL.
- o valor do :id vai para req.params
- const { id } √© destructuring:Guarda o valor e depois ele extrai s√≥ a chave id do objeto params.




req.params, req.body e req.query

    üìå params ‚Üí parte fixa da URL ‚Üí /movie/:id
        ‚Üí Geralmente quando queremos acessar um recurso espec√≠fico. Quando o valor faz parte do caminho da rota.

    üìå query ‚Üí filtros na URL ap√≥s "?" ‚Üí ?search=batman
        ‚Üí S√£o par√¢metros opcionais ‚Üí usados para pesquisa, filtros, pagina√ß√£o‚Ä¶

    üìå body ‚Üí dados enviados no POST/PUT
        - Usado para pegar dados enviados no corpo da requisi√ß√£o. Ex: cadastro de usu√°rio, login‚Ä¶

EXEMPLOS:
    app.post("/login", (req, res) => {
        console.log(req.body);
    });

    Exemplo de JSON enviado do front:
    { 
    "email": "teste@email.com",
    "senha": "1234"
    }

    O que chega no backend?
    req.body = {
    email: "teste@email.com",
    senha: "1234"
    }